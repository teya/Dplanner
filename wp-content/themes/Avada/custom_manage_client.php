<?php /* Template name: Clients */ ?><?php get_header(); ?><div class="clients">	<a id="create_clients" class="button_1" href="<?php echo get_home_url();  ?>/add-client/">+ Add Client</a></div><div  id="manange-client-table"  class="display_main">	<div class="active_clients"><?php 	$table_name = $wpdb->prefix . "custom_client"; 	$table_name_person =  $wpdb->prefix . "custom_person"; 	$table_name_tasks = $wpdb->prefix . "custom_task";	$table_name_projects = $wpdb->prefix . "custom_project"; 	$clients = $wpdb->get_results("SELECT * FROM {$table_name} ORDER BY client_name ASC");		$archived_clients = $wpdb->get_results("SELECT * FROM {$table_name} WHERE client_status = '0'");				foreach ($clients as $client){			$client_id = $client->ID;			$client_name = $client->client_name;			$client_contact_person = $client->client_contact_person;			$person = $wpdb->get_row("SELECT person_fullname FROM {$table_name_person} WHERE ID = " . $client->client_default_consultant_id);			$default_task = $wpdb->get_row("SELECT * FROM {$table_name_tasks} WHERE ID = " . $client->client_default_task);			$default_project = $wpdb->get_row("SELECT project_name FROM {$table_name_projects} WHERE ID = " . $client->client_default_project);?>			<div class="display_section delete_ajax_<?php echo $client_id; ?>">				<div class="display_title">						<ul class="contact_info">						<li>							<h2 id="name_<?php echo $client_id; ?>" class="client_info "><?php echo $client_name; ?></h2>						</li>						<li>						 <p class="display_subtitle">Contact Person: <span class="<?php echo ($client_contact_person == null) ? 'text_red' : ''; ?>"><?php echo ($client_contact_person != null) ? $client_contact_person : 'No Contact Person available'; ?></span></p>						</li>						<li>						 	<p class="display_subtitle">Phone Number: <?php echo ($client->client_phone_number)? $client->client_phone_number : '--';   ?></p>						</li>						<li>						 	<p class="display_subtitle">Main Consultant: <?php echo ($person->person_fullname)? $person->person_fullname : '--'; ?></p>						</li>												</ul>					<ul class="contact_info_footer">						<li>						 <p class="display_subtitle">Default Project: <span id="default_project_<?php echo $client_id; ?>" class="edit-client-field"><?php echo ($default_project->project_name)? $default_project->project_name : '--'; ?></span></p>						</li>						<li>						 	<p class="display_subtitle">Default Task: <span id="default_task_<?php echo $client_id; ?>" class="edit-client-field"> <?php echo ($default_task->task_name)? $default_task->task_name : '--'; ?></span></p>						</li>						<li>						 	<p class="display_subtitle">Hourly Rate: <span id="default_hourly_<?php echo $client_id; ?>" class="edit-client-field">  <?php echo ($client->client_hourly_rate)? $client->client_hourly_rate : '--'; ?> </span></p>						</li>						<li>						 	<p class="display_subtitle">Schedule: <span id="default_schedule_<?php echo $client_id; ?>" class="">  <?php echo ($client->client_maintenance_schedule)? $client->client_maintenance_schedule : '--'; ?> </span></p>						</li>						<li>							<!-- <div class="display_list" onclick="window.open('/client-information/?id=<?php // echo $client_id; ?>');" > -->															<a class="button_2 display_button" href="<?php echo get_home_url(); ?>/manage-projects//edit-client/?editID=<?php echo $client_id; ?>">Edit</a>								<div id="delete_client_<?php echo $client_id; ?>" class="button_2 display_button delete_ajax">Delete</div>								<div id="client_loader_<?php echo $client_id; ?>" class="row-update-loader" style="display: none;"></div>								<div id="manage_update_client_<?php echo $client_id; ?>" class="update_manage_client_value" style="display: none;"></div>											 							</li>											</ul>									</div>			</div><?php 	} ?>	</div></div><div style="display:none;" class="dialog_form_delete_ajax" id="dialog_form_delete_client" title="Delete Client">	<form class="delete_action_ajax" id="delete_client">		<p class="label">			Are you sure you want to delete 			<span class="delete_name"></span>			<span style="display:none;" class="delete_prep">from</span>			<span style="display:none;" class="delete_parent"></span>		</p>			<div class="button_1 delete_button_ajax">Delete</div>		<div style="display:none" class="loader delete_ajax_loader"></div>		<input type="hidden" class="delete_id" name="delete_id" />		<input type="hidden" class="delete_type" name="delete_type" value="Client" />			</form></div><div style="display:none;" class="dialog_client_information" id="dialog_client_information" title="Client Information">	<div class="full_width">		<div class="one_half">			<p class="label">Customer Info:</p>			<p class="client_name"></p>			<p class="client_address"></p>			<p class="label">Contact Person:</p>			<p class="client_contact_person"></p>			<p class="client_contact_phone"></p>			<p class="client_contact_email"></p>		</div>		<div class="one_half last">			<div class="full_width">				<p class="label">Monthly Plan: </p>				<p class="client_monthly_plan"></p>			</div>			<div class="full_width">				<p class="label">Customer Satisfaction: </p>				<p class="client_satisfaction"></p>			</div>			<div class="full_width">				<p class="label">Current Active WebDev Projects: </p>				<p class="current_active_webdev_projects"></p>			</div>			<div class="full_width">				<p class="label">Monthly Ongoing Stat: </p>				<p class="monthly_ongoing_stat"></p>			</div>		</div>	</div>	<div class="full_width">		<h3>Customer Sites</h3>		<div class="header_titles">			<div class="first_column column">URL</div>			<div class="second_column column">Site Type</div>			<div class="third_column column">Platform</div>			<div class="fourth_column column">Version</div>			<div class="fifth_column column">Username</div>			<div class="sixth_column column">Password</div>			<div class="seventh_column column">L</div>		</div>		<div class="site_container"></div>	</div></div><script type="text/javascript">	jQuery(document).ready(function() {		//Editing function for editing "Default Project", "Default Task" And "Hourly Rate"		jQuery(document).on('dblclick', '.edit-client-field', function(){			var string = jQuery(this).attr('id').split("_");			var value = jQuery(this).text();			var editing_input = jQuery('.display_subtitle .editing-value-input');			//Check if editing a value field is present to prevent double inputs.			if(editing_input.length >= 1){				return false;			}			var data_object = {				id : string[2],				type : string[1],					value : value			}			jQuery('#client_loader_'+data_object.id).show();			jQuery.ajax({								type: "POST",				url: '<?php bloginfo("template_directory"); ?>/custom_ajax-functions.php',				data:{					'type' : 'manage_edit_client',					'data_object' : data_object				},				success: function (data) {					jQuery('#client_loader_'+data_object.id).hide();					jQuery('#manage_update_client_'+data_object.id).show();					var parsed = jQuery.parseJSON(data);					console.log(parsed);					if(parsed.type == 'project'){						jQuery('#default_project_'+parsed.id).html(parsed.option_dropdown).addClass('editing-value-input');					}else if(parsed.type == 'task'){						jQuery('#default_task_'+parsed.id).html(parsed.option_dropdown).addClass('editing-value-input');					}else if(parsed.type == 'hourly'){						jQuery('#default_hourly_'+parsed.id).html(parsed.option_dropdown).addClass('editing-value-input');					}				},				error: function (data) {									}							});					});	});	//Saving function for editing "Default Project", "Default Task" And "Hourly Rate"	jQuery(document).on('click', '.update_manage_client_value', function(){		var id = jQuery(this).attr('id').split("_")[3];		var selecl_element = jQuery("#selected_id_"+id);		var type = selecl_element.attr('class');		var value = selecl_element.val();		jQuery('#client_loader_'+id).show();		jQuery('#manage_update_client_'+id).hide();		var entry_object = {			id : id,			type : type,			value : value		}		jQuery.ajax({							type: "POST",			url: '<?php bloginfo("template_directory"); ?>/custom_ajax-functions.php',			data:{				'type' : 'manage_edit_client_update',				'data_object' : entry_object			},			success: function (data) {				var parsed = jQuery.parseJSON(data);				if(parsed.type =='project'){					jQuery("#default_project_"+parsed.id).text(value).removeClass('editing-value-input');					}else if(parsed.type =='task'){					jQuery("#default_task_"+parsed.id).text(parsed.value).removeClass('editing-value-input');				}				else if(parsed.type =='hourly'){					jQuery("#default_hourly_"+parsed.id).text(parsed.value).removeClass('editing-value-input');				}				jQuery('#client_loader_'+parsed.id).hide();			},			error: function (data) {							}						});		});</script><?php get_footer(); ?>